# ロジック

要素情報を収集した状態

```
    0  1  2  3  4  5
g         l
l         q  p     g
p   l  q
q               p  l
```

要素表記順を決定する。これを行うために最初に先頭要素を決定する。先頭要素の決定ロジックは以下の通り。

1. 接続面の数が最小のもの。1つしかなければこの時点で決定。
2. 1で同点のものが複数ある場合、接続先の要素の接続面の数を含めて評価。この評価で1つに決まれば決定。決まらなければ評価する子孫を増やしていく。
3. 要素全体の数の半数まで子孫を辿ったら、その時点で同点が複数あっても、1つに決める（配列の先頭のもの）

今回の例では、「g」になる。

次に、先頭要素の接続先の最初のもの（接続面インデックスが最小のもの）がインデックス0になるように、全体を回転する。

今回の例では、右に4回回す（60×4=240度）。次のようになる。

```
    0  1  2  3  4  5
g   l     
l   q  p     g
p               l  q
q         p  l
```

次に、先頭要素から辿って要素表記順を決定する。ロジックは以下の通り。

1. 先頭要素から開始する。
2. 現在の要素の接続先を、接続面番号の昇順に再帰探索する。深さ優先探索。
   行列的には左から順で未走査要素末端まで辿っていく。

今回は g → l → q → p の順になる。

要素表記順に行列の行を並べ替える。

```
    0  1  2  3  4  5
g   l     
l   q  p     g
q         p  l
p               l  q
```

記号をインデックスへ変換する。
g → 0
l → 1
q → 2
p → 3

```
    0  1  2  3  4  5
g   1     
l   2  3     0
q         3  1
p               1  2
```

これが、構造行列になる。


検算

FKGC

```
    0  1  2  3  4  5
f      g  k
k   g              f
g   c        k  f
c            g
```
↓
先頭はc
```
    0  1  2  3  4  5
f               g  k   
k         f  g
g   k  f     c
c   g
```

並び順は c → g → k → f 

```
    0  1  2  3  4  5
c   g
g   k  f     c
k         f  g
f               g  k   
```

c → 0
g → 1
k → 2
f → 3

```
    0  1  2  3  4  5
c   1
g   2  3     0
k         3  1
f               1  2   
```

先の構造行列と一致する。
